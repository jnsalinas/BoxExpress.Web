<!-- <c-row>
  <c-col xs="12">
    <c-card class="mb-3">
      <c-card-header>
        <strong>Bodega:</strong> {{ warehouseDetail?.name }}
        <button class="btn btn-sm btn-primary float-end" (click)="openModal()">
          Agregar productos
        </button>
      </c-card-header>
      <c-card-body>
        <div class="input-group mb-3">
          <span class="input-group-text">üîç</span>
          <input
            type="text"
            class="form-control"
            placeholder="Buscar producto"
            [(ngModel)]="searchTerm"
            (input)="filterProducts()"
          />
          <button class="btn btn-outline-secondary" (click)="clearSearch()">
            Limpiar
          </button>
        </div>

        <table cTable>
          <thead>
            <tr>
              <th>Producto</th>
              <th>Variantes</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let product of filteredProducts">
              <td>
                {{ product.name }} / {{ product.sku }}
                <span class="badge bg-secondary">{{ product.sku }}</span>
              </td>
              <td>
                <div
                  *ngFor="let variant of product.variants"
                  class="p-2 mb-2 border rounded bg-light"
                >
                  <div>
                    <strong>{{ variant.name }}</strong> ({{ variant.quantity }})
                  </div>
                  <div *ngIf="variant.shopifyId" class="text-muted small">
                    Shopify ID: {{ variant.shopifyId }}
                  </div>
                  <div *ngIf="variant.sku" class="text-muted small">
                    SKU:
                    <span class="badge bg-secondary">{{ variant.sku }}</span>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </c-card-body>
    </c-card>
  </c-col>
</c-row> -->

<c-row>
  <c-col xs="12">
    <c-card class="mb-3">
      <c-card-header>
        <strong>Bodega:</strong> {{ warehouseDetail?.name }}
        <button class="btn btn-sm btn-primary float-end" (click)="openModal()">
          Agregar productos
        </button>
      </c-card-header>
      <c-card-body>
        <div class="input-group mb-3">
          <span class="input-group-text">üîç</span>
          <input
            type="text"
            class="form-control"
            placeholder="Buscar producto"
            [(ngModel)]="searchTerm"
            (input)="filterProducts()"
          />
          <button class="btn btn-outline-secondary" (click)="clearSearch()">
            Limpiar
          </button>
        </div>

        <table cTable>
          <thead>
            <tr>
              <th>Producto</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let product of filteredProducts">
              <td colspan="2">
                <div class="p-3 mb-3 border rounded bg-white shadow-sm">
                  <!-- Encabezado del producto -->
                  <div
                    class="d-flex justify-content-between align-items-center mb-2"
                  >
                    <div>
                      <h5 class="mb-0">{{ product.name }}</h5>
                      <span class="badge bg-secondary">{{ product.sku }}</span>
                    </div>
                    <div>
                      <button
                        class="btn btn-sm btn-outline-primary me-2"
                        (click)="editProduct(product)"
                      >
                        <i class="bi bi-pencil"></i>
                        <svg
                          [cIcon]="icons.cilPencil"
                          size="sm"
                          title="List Icon"
                        ></svg>
                        Editar
                      </button>
                      <button
                        class="btn btn-sm btn-outline-danger"
                        (click)="deleteProduct(product)"
                      >
                        <svg
                          [cIcon]="icons.cilTrash"
                          size="sm"
                          title="Eliminar"
                        ></svg>
                        Eliminar
                      </button>
                    </div>
                  </div>

                  <!-- Lista de variantes -->
                  <div class="ms-2">
                    <div
                      *ngFor="let variant of product.variants"
                      class="p-2 mb-2 border rounded bg-light"
                    >
                      <div class="d-flex justify-content-between">
                        <div>
                          <strong>{{ variant.name }}</strong> ({{
                            variant.quantity
                          }})
                          <div
                            *ngIf="variant.shopifyId"
                            class="text-muted small"
                          >
                            Shopify ID: {{ variant.shopifyId }}
                          </div>
                          <div *ngIf="variant.sku" class="text-muted small">
                            SKU:
                            <span class="badge bg-secondary">{{
                              variant.sku
                            }}</span>
                          </div>
                        </div>
                        <div class="text-end">
                          <button
                            class="btn btn-sm btn-outline-primary me-2"
                            (click)="editVariant(product, variant)"
                          >
                            <svg
                              [cIcon]="icons.cilPencil"
                              size="sm"
                              title="Editar"
                            ></svg>
                          </button>
                          <button
                            class="btn btn-sm btn-link text-danger"
                            (click)="deleteVariant(product, variant)"
                          >
                            <svg
                              [cIcon]="icons.cilTrash"
                              size="sm"
                              title="Eliminar"
                            ></svg>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </c-card-body>
    </c-card>
  </c-col>
</c-row>

<app-warehouse-product-modal
  *ngIf="warehouseDetail"
  [warehouseId]="warehouseDetail.id"
  [warehouseName]="warehouseDetail.name"
  [isVisible]="isModalVisible"
  [productToEdit]="productToEdit"
  (onSave)="handleSave($event)"
  (onClose)="handleClose($event)"
>
</app-warehouse-product-modal>
