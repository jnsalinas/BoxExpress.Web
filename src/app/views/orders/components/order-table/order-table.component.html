<!-- Se dejan las columnas "fijas" ya que al hacerlo de forma dinamica con swtich o ngif dentro de un ngfor de columnas para hacer el render de los td cuando se pone ngmodule y ngchange se muere el binding y no carga la pagina  -->
<table cTable>
  <thead>
    <tr>
      <th *ngIf="hasColumn('id')">Guía</th>
      <th *ngIf="hasColumn('code')">Orden</th>
      <th *ngIf="hasColumn('clientFullName')">Cliente</th>
      <th *ngIf="hasColumn('storeName')">Tienda</th>
      <th *ngIf="hasColumn('clientPhone')">Teléfono</th>
      <th *ngIf="hasColumn('clientAddress')">Dirección</th>
      <th *ngIf="hasColumn('notes')">Notas</th>
      <th *ngIf="hasColumn('deliveryFee')">Flete</th>
      <th *ngIf="hasColumn('totalAmount')">Valor total</th>
      <th *ngIf="hasColumn('contains')">Contiene</th>
      <th *ngIf="hasColumn('city')">Ciudad</th>
      <th *ngIf="hasColumn('category')">Categoría</th>
      <!-- Todo solo para el admin validar permisos -->
      <th *ngIf="hasColumn('warehouseName')">Bodega</th>
      <th *ngIf="hasColumn('status')">Estado</th>
      <th *ngIf="hasColumn('actions')">Acciones</th>
    </tr>
  </thead>

  <tbody>
    <tr
      *ngFor="let order of orders"
      [ngStyle]="{ 'border-left': '5px solid ' + getStatusColor(order.status) }"
    >
      <td *ngIf="hasColumn('id')">{{ order.id }}</td>
      <td *ngIf="hasColumn('code')">{{ order.code }}</td>
      <td *ngIf="hasColumn('clientFullName')">{{ order.clientFullName }}</td>
      <td *ngIf="hasColumn('storeName')">{{ order.storeName }}</td>
      <td *ngIf="hasColumn('clientPhone')">{{ order.clientPhone }}</td>
      <td *ngIf="hasColumn('clientAddress')">{{ order.clientAddress }}</td>
      <td *ngIf="hasColumn('notes')">{{ order.notes }}</td>
      <td *ngIf="hasColumn('deliveryFee')">{{ order.deliveryFee }}</td>
      <td *ngIf="hasColumn('totalAmount')">{{ order.totalAmount }}</td>
      <td *ngIf="hasColumn('contains')">{{ order.contains }}</td>
      <td *ngIf="hasColumn('city')">{{ order.city }}</td>
      <td *ngIf="hasColumn('category')">
        <select
          class="form-select form-select-sm"
          [(ngModel)]="order.warehouseId"
          (ngModelChange)="onWarehouseChange(order.id, $event)"
          [disabled]="warehouseOptions.length === 0 || order.categoryId !== 1"
        >
          <option [value]="null" disabled>Seleccione...</option>
          <option
            *ngFor="let warehouse of warehouseOptions"
            [value]="warehouse.id"
          >
            {{ warehouse.name }}
          </option>
        </select>
      </td>
      <td *ngIf="hasColumn('warehouseName')">{{ order.warehouseName }}</td>
      <td *ngIf="hasColumn('status')">
        <!-- <span class="badge" [ngClass]="getStatusBadgeClass(order.status)">
          {{ order.status }}
        </span> -->
        <!-- <span class="badge bg-info">{{ order.status }}</span> -->
        <select
          class="form-select form-select-sm"
          [(ngModel)]="order.statusId"
          (ngModelChange)="onStatusChange(order.id, $event)"
          [disabled]="statusOptions.length === 0"
        >
          <option [value]="null" disabled>Seleccione...</option>
          <option *ngFor="let status of statusOptions" [value]="status.id">
            {{ status.name }}
          </option>
        </select>
      </td>
      <!-- Acciones -->
      <td *ngIf="hasColumn('actions')">
        <button
          class="btn btn-sm btn-outline-primary"
          [routerLink]="[order.id]"
        >
          Ver Detalle
        </button>
      </td>
    </tr>
  </tbody>
</table>
